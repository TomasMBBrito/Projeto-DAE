### Variables
@baseUrl = http://localhost:8080/centroXYZ/api
@adminUsername = admin1
@adminPassword = admin123
@colaboradorUsername = joao
@colaboradorPassword = password123

###############################################################################
# AUTHENTICATION SERVICE
###############################################################################

### EP-AUTH: Login as Admin
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "username": "{{adminUsername}}",
  "password": "{{adminPassword}}"
}

### EP-AUTH: Login as Colaborador
# @name loginColaborador
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "username": "{{colaboradorUsername}}",
  "password": "{{colaboradorPassword}}"
}


############################################################################################
@token = Bearer eyJhbGciOiJIUzM4NCJ9.eyJzdWIiOiJhZG1pbjEiLCJyb2xlIjoiQURNSU5JU1RSQURPUiIsImlhdCI6MTc2OTEyMjUzOSwiZXhwIjoxNzY5MTI2MTM5fQ.WEtKMbvLgIlUKw7k445IDgLUV9qzQ8ek6hOVtyzLWm98wCFT_ULDuSDpYkfT4bhu


### EP-AUTH: Get Current User
GET {{baseUrl}}/auth/user
Accept: application/json
Authorization: {{token}}

### EP-AUTH: Debug
GET {{baseUrl}}/auth/debug
Accept: application/json
Authorization: {{token}}

###############################################################################
# USER SERVICE
###############################################################################

### EP01: Listar todos os utilizadores (ADMIN)
GET {{baseUrl}}/users
Authorization: {{token}}

### EP02: Obter utilizador específico (ADMIN)
GET {{baseUrl}}/users/bruno
Authorization: {{token}}

### EP03: Eliminar utilizador (ADMIN)
DELETE {{baseUrl}}/users/carla
Authorization: {{token}}

### EP04: Editar dados de utilizador (ADMIN)
PUT {{baseUrl}}/users/bruno
Authorization: {{token}}
Content-Type: application/json

{
  "name": "Bruno Carlos Costa",
  "email": "bruno_upd@mail.pt"
}

### EP05: Criar novo utilizador (ADMIN)
POST {{baseUrl}}/users
Authorization: {{token}}
Content-Type: application/json

{
  "name": "Carla Santos",
  "email": "carla@xyz.pt",
  "username": "carla",
  "password": "123456",
  "role": "RESPONSAVEL"
}

### EP06: Alterar role de utilizador (ADMIN)
PUT {{baseUrl}}/users/carla/role
Authorization: {{token}}
Content-Type: application/json

{
  "role": "ADMINISTRADOR"
}

### EP07: Alterar status de utilizador (ADMIN)
PUT {{baseUrl}}/users/bruno/status
Authorization: {{token}}
Content-Type: application/json

{
  "blocked": true
}

### EP08: Consultar publicações de um utilizador (RESPONSAVEL/ADMIN)
GET {{baseUrl}}/users/colab8/posts
Authorization: {{token}}

### EP09: Consultar minhas publicações
GET {{baseUrl}}/users/me/posts
Authorization: {{token}}

### EP11: Eliminar uma das minhas publicações
DELETE {{baseUrl}}/users/me/posts/1
Authorization: {{token}}

### EP12: Editar minhas informações pessoais
PUT {{baseUrl}}/users/me
Authorization: {{token}}
Content-Type: application/json

{
  "name": "João A. Silva",
  "email": "joao_upd@mail.pt"
}

### EP13: Alterar minha password
PUT {{baseUrl}}/users/me/password
Authorization: {{token}}
Content-Type: application/json

{
  "oldPassword": "admin123",
  "newPassword": "newPassword123"
}

###############################################################################
# SUBSCRIPTION SERVICE
###############################################################################

### EP14: Subscrever uma tag
POST {{baseUrl}}/me/tags
Authorization: {{token}}
Content-Type: application/json

{
  "id": 6
}

### EP15: Consultar tags subscritas
GET {{baseUrl}}/me/tags
Authorization: {{token}}

### EP16: Remover subscrição de uma tag
DELETE {{baseUrl}}/me/tags/6
Authorization: {{token}}

###############################################################################
# HISTORY SERVICE
###############################################################################

### EP17: Consultar histórico de um utilizador (ADMIN)
GET {{baseUrl}}/history/joao
Authorization: {{token}}

### EP18: Consultar meu próprio histórico
GET {{baseUrl}}/history/me
Authorization: {{token}}

### EP19: Consultar histórico de uma das minhas publicações
GET {{baseUrl}}/history/me/posts/21
Authorization: {{token}}

### EP20: Consultar histórico de uma publicação (ADMIN)
GET {{baseUrl}}/history/posts/1
Authorization: {{token}}

###############################################################################
# TAG SERVICE
###############################################################################

### EP21: Consultar tags existentes
GET {{baseUrl}}/tags
Authorization: {{token}}

### EP22: Consultar publicações associadas a uma tag
GET {{baseUrl}}/tags/5/posts
Authorization: {{token}}

### EP23: Consultar subscribers de uma tag (RESPONSAVEL/ADMIN)
GET {{baseUrl}}/tags/5/subscribers
Authorization: {{token}}

### EP24: Criar nova tag (RESPONSAVEL/ADMIN)
POST {{baseUrl}}/tags
Authorization: {{token}}
Content-Type: application/json

{
  "name": "Projeto Z"
}

### EP25: Atualizar nome de uma tag (RESPONSAVEL/ADMIN)
PUT {{baseUrl}}/tags/1
Authorization: {{token}}
Content-Type: application/json

{
  "name": "New Projeto X"
}

### EP26: Eliminar uma tag (RESPONSAVEL/ADMIN)
DELETE {{baseUrl}}/tags/5
Authorization: {{token}}

### EP27: Obter tag específica
GET {{baseUrl}}/tags/5
Authorization: {{token}}

###############################################################################
# PUBLICATION SERVICE
###############################################################################

### EP28: Obter todas as publicações
GET {{baseUrl}}/posts
Authorization: {{token}}

### EP29: Obter publicação específica
GET {{baseUrl}}/posts/21
Authorization: {{token}}

### Upload de publicação com ficheiro
POST {{baseUrl}}/posts
Authorization: {{token}}
Content-Type: multipart/form-data; boundary=boundary

--boundary
Content-Disposition: form-data; name="title"

Análise de Algoritmos Genéticos

--boundary
Content-Disposition: form-data; name="scientificArea"

ENVIRONMENTAL_SCIENCE
--boundary
Content-Disposition: form-data; name="publicationDate"

2025-01-15
--boundary
Content-Disposition: form-data; name="authors"

["João Silva", "Ana Ferreira"]
--boundary
Content-Disposition: form-data; name="tagIds"

[1, 2]
--boundary
Content-Disposition: form-data; name="file"; filename="AlgoritmosGeneticos.zip"
Content-Type: application/zip

< C:/Users/tomas/Desktop/AlgoritmosGeneticos.zip
--boundary--

### EP31: Atualizar publicação
PUT {{baseUrl}}/posts/7
Authorization: {{token}}
Content-Type: application/json

{
  "title": "Estudo dos Algoritmos",
  "summary": "Estudo sobre algoritmos genéticos e as diversas aplicações em IA."
}

### EP32: Eliminar publicação
DELETE {{baseUrl}}/posts/7
Authorization: {{token}}

### EP33: Alterar visibilidade de publicação
PUT {{baseUrl}}/posts/6/state
Authorization: {{token}}
Content-Type: application/json

{
  "visible": true
}

### EP34: Consultar comentários de uma publicação
GET {{baseUrl}}/posts/6/comments
Authorization: {{token}}

### EP35: Comentar uma publicação
POST {{baseUrl}}/posts/6/comments
Authorization: {{token}}
Content-Type: application/json

{
  "content": "Bem explicado!"
}

### EP36: Alterar visibilidade de um comentário
PUT {{baseUrl}}/posts/1/comments/1
Authorization: {{token}}
Content-Type: application/json

{
  "visible": true
}

### EP37: Avaliar uma publicação
POST {{baseUrl}}/posts/6/ratings
Authorization: {{token}}
Content-Type: application/json

{
  "rating": 5
}

### EP38: Associar tag a publicação
POST {{baseUrl}}/posts/6/tags/5
Authorization: {{token}}

### EP39: Desassociar tag de publicação (RESPONSAVEL/ADMIN)
DELETE {{baseUrl}}/posts/6/tags/5
Authorization: {{token}}

### EP40: Pesquisar publicações
GET {{baseUrl}}/posts/search?q=algoritmos
Authorization: {{token}}

### EP41: Ordenar publicações por data recente
GET {{baseUrl}}/posts?sort=recent
Authorization: {{token}}

### EP41b: Ordenar publicações por número de comentários
GET {{baseUrl}}/posts?sort=comments
Authorization: {{token}}

### EP41c: Ordenar publicações por rating
GET {{baseUrl}}/posts?sort=rating
Authorization: {{token}}

### EP42: Regenerar resumo com IA
PUT {{baseUrl}}/posts/6/summary
Authorization: {{token}}
Content-Type: application/json

{
  "regenerate": true
}

### EP43: Obter meus emails de notificação
GET {{baseUrl}}/users/me/emails
Authorization: {{token}}